<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates the Expected Value of Perfect Partial Information (EVPPI) for
subsets of parameters. Uses GAM non-parametric regression for single
parameter EVPPI and the SPDE-INLA method for larger parameter subsets."><title>Expected Value of Perfect Partial Information (EVPPI) for Selected
Parameters — evppi • BCEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Expected Value of Perfect Partial Information (EVPPI) for Selected
Parameters — evppi"><meta property="og:description" content="Calculates the Expected Value of Perfect Partial Information (EVPPI) for
subsets of parameters. Uses GAM non-parametric regression for single
parameter EVPPI and the SPDE-INLA method for larger parameter subsets."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BCEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/n8thangreen/BCEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Expected Value of Perfect Partial Information (EVPPI) for Selected
Parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/n8thangreen/BCEA/blob/HEAD/R/evppi.R" class="external-link"><code>R/evppi.R</code></a>, <a href="https://github.com/n8thangreen/BCEA/blob/HEAD/R/evppi.default.R" class="external-link"><code>R/evppi.default.R</code></a></small>
      <div class="d-none name"><code>evppi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the Expected Value of Perfect Partial Information (EVPPI) for
subsets of parameters. Uses GAM non-parametric regression for single
parameter EVPPI and the SPDE-INLA method for larger parameter subsets.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">evppi</span><span class="op">(</span><span class="va">he</span>, <span class="va">param_idx</span>, <span class="va">input</span>, N <span class="op">=</span> <span class="cn">NULL</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, residuals <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for bcea</span>
<span class="fu">evppi</span><span class="op">(</span><span class="va">he</span>, <span class="va">param_idx</span>, <span class="va">input</span>, N <span class="op">=</span> <span class="cn">NULL</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, residuals <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">evppi</span><span class="op">(</span><span class="va">he</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>he</dt>
<dd><p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p></dd>
<dt>param_idx</dt>
<dd><p>A vector of parameters for which the EVPPI should be
calculated. This can be given as a string (or vector of strings) of names or
a numeric vector, corresponding to the column numbers of important
parameters.</p></dd>
<dt>input</dt>
<dd><p>A matrix containing the simulations for all the parameters
monitored by the call to JAGS or BUGS. The matrix should have column names
matching the names of the parameters and the values in the vector parameter
should match at least one of those values.</p></dd>
<dt>N</dt>
<dd><p>The number of PSA simulations used to calculate the EVPPI. The
default uses all the available samples.</p></dd>
<dt>plot</dt>
<dd><p>A logical value indicating whether the triangular mesh for
SPDE-INLA should be plotted. Default set to `FALSE`.</p></dd>
<dt>residuals</dt>
<dd><p>A logical value indicating whether the fitted values for
the SPDE-INLA method should be outputted. Default set to `TRUE`.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments. The default methods to compute the EVPPI
are:
- For single-parameter:
GAM regression.
- For multi-parameter:
INLA/SPDE. However, it is possible (mainly for backward compatibility) to
use different methods. For single-parameter, the user can specify the method
of Sadatsafavi <em>et al.</em> or the method of Strong &amp; Oakley. In order to do so, it
is necessary to include the extra parameter <code>method</code> which takes as
value a string <code>"sad"</code> in the former case and a string <code>"so"</code> in
the latter. In case "sal" is selected, then it is possible to also specify
the number of "separators" (e.g. <code>n.seps=3</code>). If none is specified, the
default value <code>n.seps=1</code> is used. If <code>"so"</code> is used as method for
the calculation of the EVPPI, then the user *needs* to also specify the
number of "blocks" (e.g. <code>n.blocks=20</code>).</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Object of class `evppi`:</p>
<dl><dt>evppi</dt>
<dd><p>The computed values of evppi for all values of the
 parameter of willingness to pay.</p></dd>
<dt>index</dt>
<dd><p>A numerical vector with the index associated with the
 parameters for which the EVPPI was calculated.</p></dd>
<dt>k</dt>
<dd><p>The vector of values for the willingness to pay.</p></dd>
<dt>evi</dt>
<dd><p>The vector of values for the overall EVPPI.</p></dd>
<dt>fitted.costs</dt>
<dd><p>The fitted values for the costs.</p></dd>
<dt>fitted.effects</dt>
<dd><p>The fitted values for the effects.</p></dd>
<dt>parameters</dt>
<dd><p>A single string containing the names of the
parameters for which the EVPPI was calculated, used for plotting the EVPPI.</p></dd>
<dt>time</dt>
<dd><p>Computational time (in seconds).</p></dd>
<dt>fit.c</dt>
<dd><p>The object produced by the model fit for the costs.</p></dd>
<dt>fit.e</dt>
<dd><p>The object produced by the model fit for the effects.</p></dd>
<dt>formula</dt>
<dd><p>The formula used to fit the model.</p></dd>
<dt>method</dt>
<dd><p>A string indicating the method used to estimate the EVPPI.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The single parameter EVPPI has been calculated using the non-parametric GAM
regression developed by Strong <em>et al.</em> (2014). The multi-parameter EVPPI is
calculated using the SPDE-INLA regression method for Gaussian Process
regression developed by Heath <em>et al.</em> (2015).</p>
<p>This function has been completely changed and restructured to make it possible
to change regression method.
The method argument can now be given as a list. The first element element in the
list is a vector giving the regression method for the effects. The second gives
the regression method for the costs. The `method' argument can also be given as
before which then uses the same regression method for all curves.
All other `extra_args` can be given as before. `int.ord` can be updated using the
list formulation above to give the interactions for each different curve.
The formula argument for GAM can only be given once, either `te()` or `s() + s()`
as this is for computational reasons rather than to aid fit.
You can still plot the INLA mesh elements but not output the meshes.</p>
    </div>
    <div class="section level2">
    <h2 id="gam-regression">GAM regression<a class="anchor" aria-label="anchor" href="#gam-regression"></a></h2>
    

<p>For multi-parameter, the user can select 3 possible methods. If
<code>method = "GAM"</code> (BCEA will accept also <code>"gam"</code>, <code>"G"</code> or
<code>"g"</code>), then the computations are based on GAM regression. The user can
also specify the formula for the regression. The default option is to use a
tensor product (e.g. if there are two main parameters, <code>p1</code> and
<code>p2</code>, this amounts to setting <code>formula = "te(p1,p2)"</code>, which
indicates that the two parameters interact). Alternatively, it is possible
to specify a model in which the parameters are independent using the
notation <code>formula = "s(p1) + s(p2)"</code>. This may lead to worse accuracy in
the estimates.</p>
    </div>
    <div class="section level2">
    <h2 id="strong-et-al-gp-regression">Strong <em>et al.</em> GP regression<a class="anchor" aria-label="anchor" href="#strong-et-al-gp-regression"></a></h2>
    

<p>This is used if <code>method="GP"</code> (BCEA will also accept the specification
<code>method="gp"</code>). In this case, the user can also specify the number of
PSA runs that should be used to estimate the hyperparameters of the model
(e.g. <code>n.sim=100</code>). This value is set by default to 500.</p>
    </div>
    <div class="section level2">
    <h2 id="inla-related-options">INLA-related options<a class="anchor" aria-label="anchor" href="#inla-related-options"></a></h2>
    

<p>These are all rather technical and are described in detail in Baio <em>et al.</em> (2017).
The optional parameter vector <code>int.ord</code> can take integer values (c(1,1) is
default) and will force the predictor to include interactions: if
<code>int.ord = c(k, h)</code>, then all k-way interactions will be used for the
effects and all h-way interactions will be used for the costs. Also, the
user can specify the feature of the mesh for the "spatial" part of the
model. The optional parameter <code>cutoff</code> (default 0.3) controls the
density of the points inside the mesh. Acceptable values are typically in
the interval (0.1, 0.5), with lower values implying more points (and thus
better approximation and greater computational time). The construction of the
boundaries for the mesh can be controlled by the optional inputs
<code>convex.inner</code> (default = -0.4) and <code>convex.outer</code> (default =
-0.7). These should be negative values and can be decreased (say to -0.7 and
-1, respectively) to increase the distance between the points and the outer
boundary, which also increases precision and computational time. The
optional argument<code>robust</code> can be set to TRUE, in which case INLA will
use a t prior distribution for the coefficients of the linear predictor.
Finally, the user can control the accuracy of the INLA grid-search for the
estimation of the hyperparameters. This is done by setting a value
<code>h.value</code> (default = 0.00005). Lower values imply a more refined search
(and hence better accuracy), at the expense of computational speed. The
method argument can also be given as a list allowing different regression
methods for the effects and costs, and the different incremental decisions.
The first list element should contain a vector of methods for the
incremental effects and the second for the costs, for example
<code>method = list(c("GAM"), c("INLA"))</code>. The <code>int.ord</code> argument can also
be given as a list to give different interaction levels for each regression
curve.</p>
<p>By default, when no method is specified by the user, <code>evppi</code> will
use GAM if the number of parameters is &lt;5 and INLA otherwise.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Strong M., Oakley J. and Brennan A. (2014). Estimating
multi-parameter partial Expected Value of Perfect Information from a
probabilistic sensitivity analysis sample: a non-parametric regression
approach. Medical Decision Making.
<a href="https://doi.org/10.1177/0272989X13505910" class="external-link">https://doi.org/10.1177/0272989X13505910</a></p>
<p>Sadatsafavi M., Bansback N., Zafari Z., Najafzadeh M., Marra C. (2013). Need
for speed: an efficient algorithm for calculation of single-parameter
expected value of partial perfect information. Value in Health.
<a href="https://doi.org/10.1016/j.jval.2012.10.018" class="external-link">https://doi.org/10.1016/j.jval.2012.10.018</a></p>
<p>Baio G. (2012). Bayesian Methods in Health Economics. CRC/Chapman Hall, London.</p>
<p>Baio, G, A Berardi, and A Heath. 2017. Bayesian Cost-Effectiveness Analysis
with the R package BCEA. New York, NY: Springer. doi:10.1007/978-3-319-55718-2.</p>
<p>Heath A., Manolopoulou I., Baio G. (2016). Estimating the Expected Value of
Partial Perfect Information in Health Economic Evaluations using Integrated
Nested Laplace Approximation. Statistics in Medicine.
<a href="https://onlinelibrary.wiley.com/doi/10.1002/sim.6983/full" class="external-link">https://onlinelibrary.wiley.com/doi/10.1002/sim.6983/full</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bcea.html">bcea</a></code>,
         <code><a href="plot.evppi.html">plot.evppi</a></code>,</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Anna Heath, Gianluca Baio</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># See Baio G., Dawid A.P. (2011) for a detailed description of the </span></span>
<span class="r-in"><span class="co"># Bayesian model and economic problem</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Load the post-processed results of the MCMC simulation model</span></span>
<span class="r-in"><span class="co"># original JAGS output is can be downloaded from here</span></span>
<span class="r-in"><span class="co"># https://gianluca.statistica.it/book/bcea/code/vaccine.RData</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="Smoking.html">data</a></span><span class="op">(</span><span class="va">Vaccine</span>, package <span class="op">=</span> <span class="st">"BCEA"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">treats</span> <span class="op">&lt;-</span> <span class="fu"><a href="Smoking.html">c</a></span><span class="op">(</span><span class="st">"Status quo"</span>, <span class="st">"Vaccination"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Run the health economic evaluation using BCEA</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="bcea.html">bcea</a></span><span class="op">(</span><span class="va">e.pts</span>, <span class="va">c.pts</span>, ref <span class="op">=</span> <span class="fl">2</span>, interventions <span class="op">=</span> <span class="va">treats</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compute the EVPPI for a bunch of parameters</span></span>
<span class="r-in"><span class="va">inp</span> <span class="op">&lt;-</span> <span class="fu"><a href="createInputs.html">createInputs</a></span><span class="op">(</span><span class="va">vaccine_mat</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">EVPPI</span> <span class="op">&lt;-</span> <span class="fu">evppi</span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="Smoking.html">c</a></span><span class="op">(</span><span class="st">"beta.1."</span> , <span class="st">"beta.2."</span><span class="op">)</span>, <span class="va">inp</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">EVPPI</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># deprecated (single parameter) methods</span></span>
<span class="r-in"><span class="va">EVPPI.so</span> <span class="op">&lt;-</span> <span class="fu">evppi</span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="Smoking.html">c</a></span><span class="op">(</span><span class="st">"beta.1."</span>, <span class="st">"beta.2."</span><span class="op">)</span>, <span class="va">inp</span><span class="op">$</span><span class="va">mat</span>, method <span class="op">=</span> <span class="st">"so"</span>, n.blocks <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span class="r-in"><span class="va">EVPPI.sad</span> <span class="op">&lt;-</span> <span class="fu">evppi</span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="Smoking.html">c</a></span><span class="op">(</span><span class="st">"beta.1."</span>, <span class="st">"beta.2."</span><span class="op">)</span>, <span class="va">inp</span><span class="op">$</span><span class="va">mat</span>, method <span class="op">=</span> <span class="st">"sad"</span>, n.seps <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">EVPPI.so</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">EVPPI.sad</span><span class="op">)</span></span>
<span class="r-in"> </span>
<span class="r-in"><span class="co"># Compute the EVPPI using INLA/SPDE</span></span>
<span class="r-in"><span class="va">x_inla</span> <span class="op">&lt;-</span> <span class="fu">evppi</span><span class="op">(</span>he <span class="op">=</span> <span class="va">m</span>, <span class="fl">39</span><span class="op">:</span><span class="fl">40</span>, input <span class="op">=</span> <span class="va">inp</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># using GAM regression</span></span>
<span class="r-in"><span class="va">x_gam</span> <span class="op">&lt;-</span> <span class="fu">evppi</span><span class="op">(</span>he <span class="op">=</span> <span class="va">m</span>, <span class="fl">39</span><span class="op">:</span><span class="fl">40</span>, input <span class="op">=</span> <span class="va">inp</span><span class="op">$</span><span class="va">mat</span>, method <span class="op">=</span> <span class="st">"GAM"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># using Strong et al GP regression</span></span>
<span class="r-in"><span class="va">x_gp</span> <span class="op">&lt;-</span> <span class="fu">evppi</span><span class="op">(</span>he <span class="op">=</span> <span class="va">m</span>, <span class="fl">39</span><span class="op">:</span><span class="fl">40</span>, input <span class="op">=</span> <span class="va">inp</span><span class="op">$</span><span class="va">mat</span>, method <span class="op">=</span> <span class="st">"GP"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot results</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x_inla</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x_inla</span><span class="op">$</span><span class="va">k</span>, <span class="va">x_inla</span><span class="op">$</span><span class="va">evppi</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x_gam</span><span class="op">$</span><span class="va">k</span>, <span class="va">x_gam</span><span class="op">$</span><span class="va">evppi</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x_gp</span><span class="op">$</span><span class="va">k</span>, <span class="va">x_gp</span><span class="op">$</span><span class="va">evppi</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x_inla</span><span class="op">$</span><span class="va">k</span>, <span class="va">x_inla</span><span class="op">$</span><span class="va">evppi</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x_gam</span><span class="op">$</span><span class="va">k</span>, <span class="va">x_gam</span><span class="op">$</span><span class="va">evppi</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x_gp</span><span class="op">$</span><span class="va">k</span>, <span class="va">x_gp</span><span class="op">$</span><span class="va">evppi</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="Smoking.html">data</a></span><span class="op">(</span><span class="va">Smoking</span><span class="op">)</span></span>
<span class="r-in"><span class="va">treats</span> <span class="op">&lt;-</span> <span class="fu"><a href="Smoking.html">c</a></span><span class="op">(</span><span class="st">"No intervention"</span>, <span class="st">"Self-help"</span>,</span>
<span class="r-in"><span class="st">"Individual counselling"</span>, <span class="st">"Group counselling"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="bcea.html">bcea</a></span><span class="op">(</span><span class="va">e</span>, <span class="va">c</span>, ref <span class="op">=</span> <span class="fl">4</span>, interventions <span class="op">=</span> <span class="va">treats</span>, Kmax <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span class="r-in"><span class="va">inp</span> <span class="op">&lt;-</span> <span class="fu"><a href="createInputs.html">createInputs</a></span><span class="op">(</span><span class="va">smoking_output</span><span class="op">)</span></span>
<span class="r-in"><span class="va">EVPPI</span> <span class="op">&lt;-</span> <span class="fu">evppi</span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="Smoking.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="va">inp</span><span class="op">$</span><span class="va">mat</span>, h.value <span class="op">=</span> <span class="fl">0.0000005</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">EVPPI</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Gianluca Baio, Andrea Berardi, Anna Heath, Nathan
Green.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

